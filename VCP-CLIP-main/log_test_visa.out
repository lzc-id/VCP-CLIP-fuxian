/data/miniconda/envs/torch/lib/python3.10/site-packages/albumentations/check_version.py:147: UserWarning: Error fetching version info The read operation timed out
  data = fetch_version_info()
25-05-22 16:44:14.830 - INFO: data_path: ./dataset/mvisa/data
25-05-22 16:44:14.830 - INFO: save_path: ./results/test_visa
25-05-22 16:44:14.830 - INFO: checkpoint_path: ./vcp_weight/train_mvtec.pth
25-05-22 16:44:14.830 - INFO: config_path: ./models/model_configs/ViT-L-14-336.json
25-05-22 16:44:14.830 - INFO: pretrained_path: ./pretrained_weight/ViT-L-14-336px.pt
25-05-22 16:44:14.830 - INFO: dataset: visa
25-05-22 16:44:14.830 - INFO: model: ViT-L-14-336
25-05-22 16:44:14.830 - INFO: pretrained: openai
25-05-22 16:44:14.830 - INFO: features_list: [6, 12, 18, 24]
25-05-22 16:44:14.830 - INFO: image_size: 518
25-05-22 16:44:14.831 - INFO: seed: 333
25-05-22 16:44:14.831 - INFO: prompt_len: 2
25-05-22 16:44:14.831 - INFO: deep_prompt_len: 1
25-05-22 16:44:14.831 - INFO: device_id: 0
25-05-22 16:44:14.831 - INFO: use_global: True
25-05-22 16:44:14.831 - INFO: total_d_layer_len: 11
  0%|          | 0/68 [00:00<?, ?it/s]  1%|▏         | 1/68 [00:04<04:58,  4.46s/it]  3%|▎         | 2/68 [00:07<04:02,  3.68s/it]  4%|▍         | 3/68 [00:10<03:48,  3.52s/it]  6%|▌         | 4/68 [00:14<03:43,  3.49s/it]  7%|▋         | 5/68 [00:17<03:29,  3.32s/it]  9%|▉         | 6/68 [00:20<03:19,  3.21s/it] 10%|█         | 7/68 [00:23<03:11,  3.14s/it] 12%|█▏        | 8/68 [00:26<03:06,  3.10s/it] 13%|█▎        | 9/68 [00:29<03:00,  3.07s/it] 15%|█▍        | 10/68 [00:32<02:56,  3.04s/it] 16%|█▌        | 11/68 [00:35<02:52,  3.03s/it] 18%|█▊        | 12/68 [00:38<02:50,  3.04s/it] 19%|█▉        | 13/68 [00:41<02:46,  3.03s/it] 21%|██        | 14/68 [00:44<02:47,  3.10s/it] 22%|██▏       | 15/68 [00:47<02:42,  3.06s/it] 24%|██▎       | 16/68 [00:50<02:42,  3.13s/it] 25%|██▌       | 17/68 [00:54<02:38,  3.10s/it] 26%|██▋       | 18/68 [00:56<02:33,  3.07s/it] 28%|██▊       | 19/68 [00:59<02:28,  3.04s/it] 29%|██▉       | 20/68 [01:02<02:25,  3.02s/it] 31%|███       | 21/68 [01:05<02:21,  3.01s/it] 32%|███▏      | 22/68 [01:08<02:18,  3.00s/it] 34%|███▍      | 23/68 [01:11<02:15,  3.00s/it] 35%|███▌      | 24/68 [01:15<02:16,  3.11s/it] 37%|███▋      | 25/68 [01:18<02:18,  3.22s/it] 38%|███▊      | 26/68 [01:22<02:18,  3.29s/it] 40%|███▉      | 27/68 [01:25<02:17,  3.36s/it] 41%|████      | 28/68 [01:29<02:14,  3.36s/it] 43%|████▎     | 29/68 [01:32<02:06,  3.24s/it] 44%|████▍     | 30/68 [01:35<02:00,  3.18s/it] 46%|████▌     | 31/68 [01:38<01:55,  3.12s/it] 47%|████▋     | 32/68 [01:41<01:52,  3.12s/it] 49%|████▊     | 33/68 [01:44<01:52,  3.20s/it] 50%|█████     | 34/68 [01:48<01:51,  3.28s/it] 51%|█████▏    | 35/68 [01:51<01:46,  3.24s/it] 53%|█████▎    | 36/68 [01:54<01:41,  3.17s/it] 54%|█████▍    | 37/68 [01:57<01:40,  3.24s/it] 56%|█████▌    | 38/68 [02:00<01:37,  3.25s/it] 57%|█████▋    | 39/68 [02:03<01:32,  3.18s/it] 59%|█████▉    | 40/68 [02:06<01:27,  3.13s/it] 60%|██████    | 41/68 [02:09<01:24,  3.11s/it] 62%|██████▏   | 42/68 [02:13<01:20,  3.11s/it] 63%|██████▎   | 43/68 [02:16<01:19,  3.17s/it] 65%|██████▍   | 44/68 [02:19<01:14,  3.09s/it] 66%|██████▌   | 45/68 [02:22<01:10,  3.05s/it] 68%|██████▊   | 46/68 [02:25<01:06,  3.02s/it] 69%|██████▉   | 47/68 [02:28<01:03,  3.01s/it] 71%|███████   | 48/68 [02:31<01:00,  3.01s/it] 72%|███████▏  | 49/68 [02:34<00:57,  3.03s/it] 74%|███████▎  | 50/68 [02:37<00:54,  3.03s/it] 75%|███████▌  | 51/68 [02:40<00:51,  3.02s/it] 76%|███████▋  | 52/68 [02:43<00:48,  3.01s/it] 78%|███████▊  | 53/68 [02:46<00:47,  3.14s/it] 79%|███████▉  | 54/68 [02:49<00:44,  3.15s/it] 81%|████████  | 55/68 [02:52<00:40,  3.11s/it] 82%|████████▏ | 56/68 [02:56<00:37,  3.11s/it] 84%|████████▍ | 57/68 [02:59<00:35,  3.19s/it] 85%|████████▌ | 58/68 [03:02<00:31,  3.15s/it] 87%|████████▋ | 59/68 [03:05<00:28,  3.11s/it] 88%|████████▊ | 60/68 [03:08<00:24,  3.08s/it] 90%|████████▉ | 61/68 [03:11<00:21,  3.05s/it] 91%|█████████ | 62/68 [03:14<00:18,  3.14s/it] 93%|█████████▎| 63/68 [03:17<00:15,  3.09s/it] 94%|█████████▍| 64/68 [03:20<00:12,  3.06s/it] 96%|█████████▌| 65/68 [03:23<00:09,  3.04s/it] 97%|█████████▋| 66/68 [03:26<00:06,  3.05s/it] 99%|█████████▊| 67/68 [03:29<00:03,  3.06s/it]100%|██████████| 68/68 [03:31<00:00,  2.66s/it]100%|██████████| 68/68 [03:31<00:00,  3.11s/it]
candle--->  iou:0.3304554284480898   f1-max:0.4967637582848985  threshold:0.6879584193229675
visualization candle
capsules--->  iou:0.3941251415628539   f1-max:0.5654134066793748  threshold:0.6405072212219238
visualization capsules
cashew--->  iou:0.19738336743014923   f1-max:0.3296931703354141  threshold:0.3152972161769867
visualization cashew
chewinggum--->  iou:0.6438400081606185   f1-max:0.7833392752135084  threshold:0.8011211156845093
visualization chewinggum
fryum--->  iou:0.20121963377575056   f1-max:0.33502629132062633  threshold:0.4523894786834717
visualization fryum
macaroni1--->  iou:0.19162333027429387   f1-max:0.3216463040641632  threshold:0.7084974050521851
visualization macaroni1
macaroni2--->  iou:0.04720251165998222   f1-max:0.09018282257109178  threshold:0.850174069404602
visualization macaroni2
pcb1--->  iou:0.07534483844555016   f1-max:0.14013451337871793  threshold:0.7869190573692322
visualization pcb1
pcb2--->  iou:0.13966811171475613   f1-max:0.24511129629107842  threshold:0.8172028064727783
visualization pcb2
pcb3--->  iou:0.12145415207178284   f1-max:0.2166081220999248  threshold:0.8356268405914307
visualization pcb3
pcb4--->  iou:0.22566424401286786   f1-max:0.3682341472145296  threshold:0.7903549075126648
visualization pcb4
pipe_fryum--->  iou:0.20713319557468707   f1-max:0.343183210456635  threshold:0.3558500111103058
visualization pipe_fryum
25-05-22 17:27:32.513 - INFO: 
| objects    |   auroc_px |   aupro_px |   ap_px |   f1_px |   iou |   auroc_sp |   aupro_sp |   ap_sp |   f1_sp |   threshold |
|:-----------|-----------:|-----------:|--------:|--------:|------:|-----------:|-----------:|--------:|--------:|------------:|
| candle     |      99.19 |      95.83 |   42.27 |   49.68 | 33.05 |      91.12 |          0 |   93.18 |   83.9  |       0.688 |
| capsules   |      98.69 |      90.98 |   51.82 |   56.54 | 39.41 |      85.97 |          0 |   92.36 |   84    |       0.641 |
| cashew     |      92.98 |      95.18 |   25.64 |   32.97 | 19.74 |      91.3  |          0 |   95.98 |   88.46 |       0.315 |
| chewinggum |      99.52 |      91.49 |   85.34 |   78.33 | 64.38 |      94.74 |          0 |   97.81 |   92.15 |       0.801 |
| fryum      |      94.63 |      91.78 |   28.61 |   33.5  | 20.12 |      77.8  |          0 |   89.44 |   80.39 |       0.452 |
| macaroni1  |      99.64 |      97.62 |   26.02 |   32.16 | 19.16 |      89.74 |          0 |   91.01 |   83.33 |       0.708 |
| macaroni2  |      98.64 |      89.99 |    3.18 |    9.02 |  4.72 |      64.01 |          0 |   65.31 |   69.57 |       0.85  |
| pcb1       |      92.4  |      88.47 |    8.48 |   14.01 |  7.53 |      73.75 |          0 |   79.11 |   69.65 |       0.787 |
| pcb2       |      92.03 |      78.74 |   15.63 |   24.51 | 13.97 |      79.81 |          0 |   80.96 |   76.5  |       0.817 |
| pcb3       |      89.51 |      78.48 |   13.34 |   21.66 | 12.15 |      74.36 |          0 |   75.87 |   72.8  |       0.836 |
| pcb4       |      95.56 |      89.68 |   31.12 |   36.82 | 22.57 |      96.55 |          0 |   96.33 |   91.63 |       0.79  |
| pipe_fryum |      96.36 |      96.84 |   26.55 |   34.32 | 20.71 |      86.86 |          0 |   93.77 |   85.58 |       0.356 |
| mean       |      95.76 |      90.42 |   29.83 |   35.29 | 23.13 |      83.83 |          0 |   87.59 |   81.5  |       0.67  |
./vcp_weight/train_mvtec.pth
